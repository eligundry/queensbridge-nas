{
    http_port 8080
    https_port 8443
}

# QBittorrent Web UI
it-was-written.tail7aee2.ts.net:8444 {
    tls {
        get_certificate tailscale
    }
    reverse_proxy localhost:8888 {
        header_up X-Forwarded-For {remote_host}
        header_up X-Forwarded-Proto https
        header_up X-Forwarded-Host {host}
        header_up X-Real-IP {remote_host}
    }
}

# Plex Media Server
it-was-written.tail7aee2.ts.net:8445 {
    tls {
        get_certificate tailscale
    }
    reverse_proxy localhost:32400 {
        header_up X-Forwarded-For {remote_host}
        header_up X-Forwarded-Proto https
        header_up X-Forwarded-Host {host}
        header_up X-Real-IP {remote_host}
        header_up X-Plex-Client-Identifier "caddy-proxy"

        transport http {
            read_timeout 0
            write_timeout 0
        }
    }
}

# Home Assistant
it-was-written.tail7aee2.ts.net:8446 {
    tls {
        get_certificate tailscale
    }
    reverse_proxy localhost:8123 {
        header_up X-Forwarded-For {remote_host}
        header_up X-Forwarded-Proto https
        header_up X-Forwarded-Host {host}
        header_up Host localhost:8123
    }
}

# Synology NAS Web UI (HTTPS)
it-was-written.tail7aee2.ts.net:8443 {
    tls {
        get_certificate tailscale
    }
    reverse_proxy https://localhost:5001 {
        transport http {
            tls_insecure_skip_verify
        }
    }
}
